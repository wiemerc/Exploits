.intel_syntax noprefix

.code64
jmp	l_data
l_code:
mov	rdi, 1		# file descriptor
pop	rsi	        # pointer to buffer
mov	rdx, 13		# buffer size
mov	rax, 1		# sys_write
syscall

mov rdi, 99 	# exit code
mov	rax, 60		# sys_exit
syscall

l_data:
call	l_code
# The string below can't end with \n because that would terminate fgets()
# and the rest of "attack string" would not be read.
msg:	.asciz "hello, world"
