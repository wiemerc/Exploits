#define SECURITY_WIN32
#include <windows.h>
#include <sspi.h>
#include <stdio.h>

int main()
{
    ULONG n_packages;
    SecPkgInfo *p_packages;
    SECURITY_STATUS status;

    if ((status = EnumerateSecurityPackages(&n_packages, &p_packages)) == SEC_E_OK) {
        printf("EnumerateSecurityPackages() succeeded, the following packages are available:\n");
        for (int i = 0; i < n_packages; ++i) {
            printf("%s\n", p_packages[i].Name);
        }
        FreeContextBuffer(p_packages);
        return 0;
    }
    else {
        printf("EnumerateSecurityPackages() failed with error code 0x%08x\n", status);
        return 1;
    }
}